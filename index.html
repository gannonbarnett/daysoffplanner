<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Days Off</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="common.css">
    <link rel="icon" href="icon.png">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.1.1"></script>
    <script src="index.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.3.0/firebase.js"></script>
    <script type="module"> // Firebase init.
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js'
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js'
      import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js'
      import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js'
      import 'https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js'

      const firebaseConfig = {
        apiKey: "AIzaSyAOxa1tqQgoTPgswVW-7mTQBEfiYVrL2mI",
        authDomain: "daysoffplanner.firebaseapp.com",
        projectId: "daysoffplanner",
        storageBucket: "daysoffplanner.appspot.com",
        messagingSenderId: "999511004889",
        appId: "1:999511004889:web:eb57c65f29eeffb97bd0c8",
        measurementId: "G-6CX91Q6S19"
      };

      // Initialize Firebase
      export const app = initializeApp(firebaseConfig);
      export const analytics = getAnalytics(app);
      export const auth = getAuth(app);

      var uiConfig = {
        callbacks: {
          signInSuccessWithAuthResult: function(authResult, redirectUrl) {
            // User successfully signed in.
            // Return type determines whether we continue the redirect automatically
            // or whether we leave that to developer to handle.
            console.log(authResult);
            console.log(redirectUrl);
            return true;
          },
          uiShown: function() {
            // The widget is rendered.
            // Hide the loader.
            // document.getElementById('loader').style.display = 'none';
          },
          signInFailure: function(error) {
            console.log(error);
          },
        },
        signInFlow: 'popup',
        signInSuccessUrl: '/',
        signInOptions: [
          // Leave the lines as is for the providers you want to offer your users.
          firebase.auth.EmailAuthProvider.PROVIDER_ID,
          firebase.auth.GoogleAuthProvider.PROVIDER_ID,
          firebase.auth.TwitterAuthProvider.PROVIDER_ID,
          firebase.auth.GithubAuthProvider.PROVIDER_ID
        ],
        tosUrl: '/',
        privacyPolicyUrl: '/',
      };

      var ui = new firebaseui.auth.AuthUI(auth);
      ui.start('#firebaseui-auth-container', uiConfig);

      onAuthStateChanged(auth, (user) => {
        if (user) {
          const uid = user.uid;
          console.log(uid);
        } else {
          console.log("no user");
        }
      });
    </script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />
  </head>
  <body>
    <div class="subscribe-horizontal">
      <div class="subscribe-body">
        Make an account for $5 a year to save your progress.
        <div>
          <div id="firebaseui-auth-container"></div>
        </div>
      </div>
    </div>
    <div class="container main-horizontal" style="margin-left:25%; width:75%;">
      <div class="header-div">
        <ul class="header-ul">
          <li class="header-li title">Days Off Planner</li>
          <li class="header-li" style="float:right">
            <div class="holidays-div">
              <div onclick="toggleHolidayList()">Holidays</div>
              <div id="holidays-content-div-id" class="holidays-content-div"> </div>
            </div>
          </li>
          <li class="header-li" style="float:right">
            <div id="input-div">
              Current Balance (Days): <input id="pinned-balance-value" type="number"
                step="any"
                value="0.0"
                onchange="currentBalanceChanged()"/>
            </div>
          </li>
          <li class="header-li" style="float:right">
            <div id="input-div">
              Days Off Per Year: <input id="timeoff-rate" type="number"
                step="any"
                value="15"
                onchange="reloadGraph()"/>
            </div>
          </li>
        </ul>
      </div>
      
      <div class="non-header-div">
        <div id="annual-div-id" class="annual-div" onload="loadFromCookies()">
        </div>
        <div class="chart-div"><canvas id="chart"></canvas></div>
      </div>
    </div>
  </body>
</html>
